// ═══════════════════════════════════════════════════════════════════════════
// TEST_NEW_FEATURES.IFA - Unit Tests for New Language Features
// Tests: Negative Indexing, String Slicing, Object Method Calls
// ═══════════════════════════════════════════════════════════════════════════

iba Irosu;
import Ogunda;
iba Okanran;

// ═══════════════════════════════════════════════════════════════════════════
// FEATURE 1: NEGATIVE INDEXING
// arr[-1] = last element, arr[-2] = second-to-last, etc.
// ═══════════════════════════════════════════════════════════════════════════

ese test_negative_indexing() {
    ayanmo arr = [1, 2, 3, 4, 5];
    
    // Test negative index access
    ayanmo last = arr[-1];
    ayanmo second_last = arr[-2];
    
    Okanran.daju(5, last, "arr[-1] should be last element (5)");
    Okanran.daju(4, second_last, "arr[-2] should be second-to-last (4)");
    
    // Test negative index on strings
    ayanmo str = "Hello";
    ayanmo last_char = str[-1];
    Okanran.daju("o", last_char, "str[-1] should be last char 'o'");
    
    Irosu.fo("✓ test_negative_indexing passed");
}

// ═══════════════════════════════════════════════════════════════════════════
// FEATURE 2: STRING SLICING
// str[0:5], str[-5:], str[::2] - Python-style slicing
// ═══════════════════════════════════════════════════════════════════════════

ese test_string_slicing() {
    ayanmo str = "Hello World";
    
    // Basic slicing
    ayanmo hello = str[0:5];
    Okanran.daju("Hello", hello, "str[0:5] should be 'Hello'");
    
    // Slice from index to end
    ayanmo world = str[6:];
    Okanran.daju("World", world, "str[6:] should be 'World'");
    
    // Negative index slicing
    ayanmo last_five = str[-5:];
    Okanran.daju("World", last_five, "str[-5:] should be 'World'");
    
    // Array slicing works too
    ayanmo arr = [1, 2, 3, 4, 5];
    ayanmo first_three = arr[0:3];
    Okanran.daju(3, Ogunda.gigun(first_three), "arr[0:3] should have 3 elements");
    
    Irosu.fo("✓ test_string_slicing passed");
}

// ═══════════════════════════════════════════════════════════════════════════
// FEATURE 3: OBJECT METHOD CALLS
// obj.method() - call methods on object instances
// ═══════════════════════════════════════════════════════════════════════════

ese test_object_methods() {
    // Create an object with methods stored as dict
    ayanmo greet_fn = (name) -> { return "Hello, " + name; };
    ayanmo person = { "name": "Adé", "greet": greet_fn };
    
    // Call method on object
    ayanmo greeting = person.greet("World");
    Okanran.daju("Hello, World", greeting, "person.greet('World') should work");
    
    // Access field through method-like syntax
    ayanmo name = person.name();
    Okanran.daju("Adé", name, "person.name() should return 'Adé'");
    
    Irosu.fo("✓ test_object_methods passed");
}

// ═══════════════════════════════════════════════════════════════════════════
// RUN ALL TESTS
// ═══════════════════════════════════════════════════════════════════════════

Irosu.fo("═══ Testing New Language Features ═══");
Irosu.fo("Features: Negative Indexing, String Slicing, Object Methods\n");

test_negative_indexing();
test_string_slicing();
test_object_methods();

Irosu.fo("\n═══ All new feature tests passed! ═══");
àṣẹ;
