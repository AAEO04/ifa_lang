<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>?b? - Resource Lifecycle - Ifá-Lang</title>
    <link rel="stylesheet" href="js/common.css">
    <style>
        :root {
            --bg-dark: #0f0f1a;
            --bg-card: #1a1a2e;
            --accent: #e94560;
            --gold: #ffd700;
            --text: #eaeaea;
            --text-dim: #a0a0a0;
            --success: #4ade80;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 2px solid var(--accent);
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--gold), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            color: var(--gold);
            border-bottom: 1px solid var(--accent);
            padding-bottom: 0.5rem;
            margin: 2.5rem 0 1rem;
        }

        h3 {
            color: var(--accent);
            margin: 1.5rem 0 0.5rem;
        }

        p {
            margin: 1rem 0;
        }

        pre {
            background: #0d1321;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--gold);
        }

        .method {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--accent);
        }

        .method h3 {
            margin-top: 0;
        }

        .concept {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }

        .concept-item {
            background: var(--bg-card);
            padding: 1rem;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        .concept-item h4 {
            color: var(--gold);
            margin-bottom: 0.5rem;
        }

        .concept-item p {
            color: var(--text-dim);
            font-size: 0.9rem;
            margin: 0;
        }

        a {
            color: var(--gold);
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-dim);
            border-top: 1px solid var(--accent);
            margin-top: 3rem;
        }
    </style>
</head>`r`n`r`n<body>
    <div id="nav-placeholder"></div>`r`n
    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="breadcrumbs-container">
            <ul class="breadcrumb-list">
                <!-- Breadcrumbs will be generated by JavaScript -->
            </ul>
        </div>
    </div>
    <div class="container">
        <header>
            <h1>?? ?b? - Resource Lifecycle</h1>
            <p style="color: var(--text-dim);">RAII resource management inspired by Yoruba sacrifice traditions</p>
        </header>

        <h2>What is ?b??</h2>
        <p><strong>?b?</strong> (Yoruba: "sacrifice/offering") is Ifá-Lang's resource lifecycle system. It ensures
            cleanup code runs automatically when resources go out of scope — similar to Rust's RAII, Go's defer, or C++
            destructors.</p>

        <div class="concept">
            <div class="concept-item">
                <h4>??? Ebo Guard</h4>
                <p>Zero-cost RAII guard that runs cleanup on drop</p>
            </div>
            <div class="concept-item">
                <h4>?? EboScope</h4>
                <p>Wraps a resource with automatic cleanup</p>
            </div>
            <div class="concept-item">
                <h4>? defer!</h4>
                <p>Go-style defer for end-of-scope cleanup</p>
            </div>
        </div>

        <h2>Basic Usage</h2>
        <div class="method">
            <h3>ebo "resource";</h3>
            <p>Declare a resource lifecycle. Cleanup runs when the scope ends.</p>
            <pre><code>// Open a file with automatic cleanup
ebo "tempfile";
ayanmo file = Odi.write("temp.txt", "data");

// When scope ends, resource is cleaned up automatically</code></pre>
        </div>

        <h2>Ebo Guard (Rust API)</h2>
        <div class="method">
            <h3>Ebo::new(name, cleanup)</h3>
            <p>Create a guard that runs cleanup when dropped.</p>
            <pre><code>// Create RAII guard
ayanmo guard = Ebo.new("db_connection", || {
    db.close();
});

// Do work with database...

// Cleanup runs automatically when guard drops</code></pre>
        </div>

        <div class="method">
            <h3>guard.dismiss()</h3>
            <p>Cancel cleanup — resource will NOT be cleaned up.</p>
            <pre><code>ayanmo guard = Ebo.new("lock", || release_lock());

// Decide to keep the lock
guard.dismiss();  // Cleanup cancelled</code></pre>
        </div>

        <div class="method">
            <h3>guard.sacrifice()</h3>
            <p>Run cleanup early, then dismiss the guard.</p>
            <pre><code>ayanmo guard = Ebo.new("cache", || cache.flush());

// Force early cleanup
guard.sacrifice();  // Runs immediately, not on scope exit</code></pre>
        </div>

        <h2>EboScope (Scoped Resources)</h2>
        <div class="method">
            <h3>EboScope::new(value, cleanup)</h3>
            <p>Wrap a value with automatic cleanup when scope ends.</p>
            <pre><code>// Scoped file handle
ayanmo scoped = EboScope.new(
    Odi.open("data.txt"),
    |file| file.sync()  // Cleanup: sync before close
);

// Use the file
scoped.write("Hello");

// sync() called automatically when scoped drops</code></pre>
        </div>

        <div class="method">
            <h3>scoped.into_inner()</h3>
            <p>Extract the value, running cleanup first.</p>
            <pre><code>ayanmo scoped = EboScope.new(42, |n| Irosu.fo("Cleaned: " + n));
ayanmo value = scoped.into_inner();  // Prints "Cleaned: 42"</code></pre>
        </div>

        <div class="method">
            <h3>scoped.leak()</h3>
            <p>Extract value WITHOUT running cleanup.</p>
            <pre><code>ayanmo scoped = EboScope.new(resource, |r| r.close());
ayanmo leaked = scoped.leak();  // No cleanup runs</code></pre>
        </div>

        <h2>defer! Macro (Go-style)</h2>
        <div class="method">
            <h3>defer!(cleanup)</h3>
            <p>Run cleanup at end of current scope (like Go's defer).</p>
            <pre><code>ise process() {
    defer!(|| Irosu.fo("Done processing"));
    
    // Do work...
    Irosu.fo("Working...");
    
    // "Done processing" printed when function returns
}</code></pre>
        </div>

        <h2>Use Cases</h2>
        <ul style="margin-left: 2rem; color: var(--text-dim);">
            <li><strong>File handles:</strong> Auto-close files on scope exit</li>
            <li><strong>Database connections:</strong> Release connections to pool</li>
            <li><strong>Locks:</strong> Automatically release mutexes</li>
            <li><strong>Temporary files:</strong> Delete temp files on cleanup</li>
            <li><strong>Network sockets:</strong> Close connections gracefully</li>
        </ul>

        <footer class="doc-footer">
            <p><a href="ewo.html">Èw?` (Taboos/Assertions) ?</a></p>
            <p><a href="api/api.html">? API Reference</a> · <a href="index.html">Documentation Home</a></p>
        </footer>
    </div>
        <script src="js/nav.js"></script>
    <script src="js/common.js"></script>
</body>

</html>

