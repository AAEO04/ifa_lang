<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Deployment - Ifá-Lang Use Cases</title>
    <style>
        :root {
            --bg-dark: #0f0f1a;
            --bg-card: #1a1a2e;
            --accent: #e94560;
            --gold: #ffd700;
            --text: #eaeaea;
            --text-dim: #a0a0a0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        h1 {
            color: var(--gold);
            font-size: 2.5rem;
        }

        h2 {
            color: var(--gold);
            margin: 2.5rem 0 1rem;
            border-bottom: 1px solid var(--accent);
            padding-bottom: 0.5rem;
        }

        h3 {
            color: var(--accent);
            margin: 1.5rem 0 0.5rem;
        }

        p {
            margin: 1rem 0;
        }

        pre {
            background: #0d1321;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--gold);
        }

        a {
            color: var(--gold);
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-dim);
            border-top: 1px solid var(--accent);
            margin-top: 3rem;
        }
    </style>
</head>


    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="breadcrumbs-container">
            <ul class="breadcrumb-list">
                <!-- Breadcrumbs will be generated by JavaScript -->
            </ul>
        </div>
    </div>
    <div class="container">
        <h1>?? Cloud Deployment</h1>
        <p>Deploy Ifá-Lang applications to Docker containers and cloud platforms.</p>

        <h2>Docker Container</h2>

        <h3>Dockerfile</h3>
        <pre><code># Build stage
FROM rust:1.75 AS builder
WORKDIR /app

# Copy manifests
COPY Cargo.toml Cargo.lock ./
COPY crates/ crates/

# Build release binary
RUN cargo build --release -p ifa-cli

# Runtime stage
FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y ca-certificates && rm -rf /var/lib/apt/lists/*

COPY --from=builder /app/target/release/ifa /usr/local/bin/ifa
COPY app/ /app/

WORKDIR /app
EXPOSE 8080

CMD ["ifa", "run", "main.ifa"]</code></pre>

        <h3>docker-compose.yml</h3>
        <pre><code>version: '3.8'

services:
  app:
    build: .
    ports:
      - "8080:8080"
    environment:
      - IFA_ENV=production
      - DATABASE_URL=postgres://db:5432/myapp
    depends_on:
      - db
    restart: unless-stopped

  db:
    image: postgres:16
    environment:
      POSTGRES_DB: myapp
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:</code></pre>

        <h2>Cloud Platforms</h2>

        <h3>AWS Lambda (WASM)</h3>
        <pre><code># Build WASM for Lambda
cd crates/ifa-wasm
wasm-pack build --target nodejs --out-dir lambda/pkg

# Lambda handler (JavaScript wrapper)
# lambda/index.js
const { run_ifa } = require('./pkg');

exports.handler = async (event) => {
    const result = run_ifa(event.code);
    return {
        statusCode: 200,
        body: JSON.stringify({ output: result })
    };
};</code></pre>

        <h3>Google Cloud Run</h3>
        <pre><code># Build and push to GCR
gcloud builds submit --tag gcr.io/PROJECT_ID/ifa-app

# Deploy
gcloud run deploy ifa-app \
  --image gcr.io/PROJECT_ID/ifa-app \
  --platform managed \
  --memory 256Mi \
  --cpu 1 \
  --port 8080 \
  --allow-unauthenticated</code></pre>

        <h3>Fly.io</h3>
        <pre><code># fly.toml
app = "my-ifa-app"
primary_region = "ord"

[build]
  dockerfile = "Dockerfile"

[http_service]
  internal_port = 8080
  force_https = true
  auto_start_machines = true
  auto_stop_machines = true

# Deploy
fly launch
fly deploy</code></pre>

        <h2>Environment Configuration</h2>
        <pre><code>// config.ifa - Environment-aware configuration

ise get_config() {
    ayanmo env = Ogbe.env("IFA_ENV");
    ti (env == nil) { ayanmo env = "development"; }
    
    ti (env == "production") {
        padap? {
            "port": Ogbe.env_int("PORT", 8080),
            "database": Ogbe.env("DATABASE_URL"),
            "log_level": "warn",
            "debug": iro
        };
    } bib?k? ti (env == "staging") {
        padap? {
            "port": 8080,
            "database": Ogbe.env("DATABASE_URL"),
            "log_level": "info",
            "debug": otito
        };
    } bib?k? {
        padap? {
            "port": 3000,
            "database": "sqlite://dev.db",
            "log_level": "debug",
            "debug": otito
        };
    }
}

ayanmo config = get_config();
Irosu.fo("Starting in " + Ogbe.env("IFA_ENV") + " mode");</code></pre>

        <h2>Health Checks</h2>
        <pre><code>// health.ifa - Health check endpoint

ise health_handler(request) {
    ayanmo status = {
        "status": "healthy",
        "version": "1.2.2",
        "uptime": Kernel.uptime(),
        "memory": Kernel.memory_stats()
    };
    
    // Check database
    ayanmo db_ok = Okanran.try(|| {
        ayanmo db = Odi.db_open(config["database"]);
        Odi.db_query(db, "SELECT 1");
        Odi.db_close(db);
        padap? otito;
    });
    
    ti (Okanran.is_error(db_ok)) {
        status["status"] = "degraded";
        status["database"] = "unavailable";
    } bib?k? {
        status["database"] = "connected";
    }
    
    padap? Backend.json_response(status);
}

Backend.route("GET", "/health", health_handler);</code></pre>

        <footer class="doc-footer">
            <p><a href="database.html">? Database</a> · <a href="../../index.html">Use Cases Index</a></p>
            <p><a href="../../index.html">Documentation Home</a></p>
        </footer>
    </div>
    <script src="../../js/nav.js"></script>
    <script src="../../js/common.js"></script>
</body>

</html>

