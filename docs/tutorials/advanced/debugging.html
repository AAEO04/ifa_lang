<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debugging Guide - Ifá-Lang</title>
    <style>
        :root {
            --bg-dark: #0f0f1a;
            --bg-card: #1a1a2e;
            --accent: #e94560;
            --gold: #ffd700;
            --text: #eaeaea;
            --text-dim: #a0a0a0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        h1 {
            color: var(--gold);
            font-size: 2.5rem;
        }

        h2 {
            color: var(--gold);
            margin: 2.5rem 0 1rem;
            border-bottom: 1px solid var(--accent);
            padding-bottom: 0.5rem;
        }

        h3 {
            color: var(--accent);
            margin: 1.5rem 0 0.5rem;
        }

        p {
            margin: 1rem 0;
        }

        pre {
            background: #0d1321;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--gold);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th,
        td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-card);
        }

        th {
            color: var(--gold);
        }

        a {
            color: var(--gold);
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-dim);
            border-top: 1px solid var(--accent);
            margin-top: 3rem;
        }
    </style>
</head>

<body>
    <div id="nav-placeholder"></div>
    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="breadcrumbs-container">
            <ul class="breadcrumb-list">
                <!-- Breadcrumbs will be generated by JavaScript -->
            </ul>
        </div>
    </div>
    <div class="container">
        <h1>?? Debugging Guide</h1>
        <p>Comprehensive debugging techniques for Ifá-Lang programs.</p>

        <h2>Static Analysis with Babalawo</h2>
        <p>Catch errors before runtime using the Babalawo linter:</p>
        <pre><code># Basic check
ifa check myfile.ifa

# Full linting with proverbs
ifa babalawo myfile.ifa

# Strict mode (warnings become errors)
ifa babalawo --strict myfile.ifa

# Fast mode (skip proverbs for speed)
ifa babalawo --fast myfile.ifa

# Output formats
ifa babalawo --format=minimal myfile.ifa
ifa babalawo --format=compact myfile.ifa
ifa babalawo --format=verbose myfile.ifa
ifa babalawo --format=json myfile.ifa</code></pre>

        <h2>LSP Diagnostics</h2>
        <p>Get real-time errors in your IDE via the LSP server:</p>
        <pre><code># Start LSP server (IDE connects automatically)
ifa lsp

# Diagnostics appear as you type:
# - Parse errors (red squiggles)
# - Type warnings (yellow squiggles)
# - Unused variables (gray text)
# - Taboo violations (red underline)</code></pre>

        <h2>Runtime Debugging</h2>

        <h3>Print Debugging</h3>
        <pre><code>// stdout debugging
Irosu.fo("Variable x = " + x);

// stderr for errors
Irosu.kigbe("ERROR: " + error_message);

// Pretty print objects
Irosu.fo(Ogbe.format_json(my_object));</code></pre>

        <h3>Trace Decorator</h3>
        <pre><code>ise trace(name, func) {
    ayanmo start = Iwori.now_ms();
    Irosu.fo("[TRACE] ? " + name);
    
    ayanmo result = func();
    
    ayanmo elapsed = Iwori.now_ms() - start;
    Irosu.fo("[TRACE] ? " + name + " (" + elapsed + "ms)");
    padap? result;
}

// Usage
ayanmo result = trace("process_data", || {
    process(data);
});</code></pre>

        <h3>Flight Recorder (Opon)</h3>
        <p>The VM's Opon (memory calabash) records the last 128 operations for post-mortem debugging:</p>
        <pre><code># After a crash, dump memory history
# (Automatically written to stderr on panic)

# Shows:
# - Memory allocations
# - Variable assignments  
# - Function calls
# - Last executed line</code></pre>

        <h2>REPL Debugging</h2>
        <pre><code># Interactive exploration
ifa repl

>>> ayanmo data = [1, 2, 3, 4, 5]
>>> Ogunda.len(data)
5
>>> Osa.sum(data)
15
>>> ti (data[0] > 0) { Irosu.fo("positive"); }
positive</code></pre>

        <h2>Sandbox Debugging</h2>
        <pre><code># Run in sandbox with timeout
ifa sandbox run --timeout=30 script.ifa

# Check why a capability was denied
ifa run --sandbox=native --allow-read=./data script.ifa
# Error: Permission denied: NetConnect for api.example.com
# Solution: Add --allow-net=api.example.com</code></pre>

        <h2>Error Messages</h2>
        <table>
            <tr>
                <th>Error Type</th>
                <th>Meaning</th>
                <th>Common Fix</th>
            </tr>
            <tr>
                <td><code>Undefined variable</code></td>
                <td>Used before declaration</td>
                <td>Check spelling, add <code>ayanmo</code></td>
            </tr>
            <tr>
                <td><code>Type mismatch</code></td>
                <td>Wrong type for operation</td>
                <td>Use <code>Ogbe.parse_*</code> for conversion</td>
            </tr>
            <tr>
                <td><code>Index out of bounds</code></td>
                <td>List access beyond length</td>
                <td>Check <code>Ogunda.len()</code> first</td>
            </tr>
            <tr>
                <td><code>Division by zero</code></td>
                <td>Divide by 0</td>
                <td>Add zero check</td>
            </tr>
            <tr>
                <td><code>Permission denied</code></td>
                <td>Sandbox capability missing</td>
                <td>Add <code>--allow-*</code> flag</td>
            </tr>
            <tr>
                <td><code>Taboo violation</code></td>
                <td>Forbidden module dependency</td>
                <td>Refactor architecture</td>
            </tr>
        </table>

        <h2>Native Build Debugging</h2>
        <pre><code># Build with debug symbols
ifa build --debug myapp.ifa

# On crash, get backtrace
RUST_BACKTRACE=1 ./myapp

# Use GDB/LLDB
gdb ./myapp
(gdb) run
(gdb) bt  # backtrace on crash</code></pre>

        <h2>WASM Debugging</h2>
        <pre><code># Browser DevTools:
# 1. Open Console tab
# 2. Set breakpoints in Sources panel
# 3. Check Network tab for failed requests

# Source maps (when available):
# - Compiled .wasm maps to .ifa source
# - Step through original code in debugger</code></pre>

        <footer class="doc-footer">
            <p><a href="../testing.html">? Testing</a> · <a href="../performance.html">Performance ?</a>
            </p>
            <p><a href="../../index.html">Documentation Home</a></p>
        </footer>
    </div>
    <script src="../../js/nav.js"></script>
    <script src="../../js/common.js"></script>
</body>

</html>