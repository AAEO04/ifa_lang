<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Language Internals - Ifá-Lang</title>
    <style>
        :root {
            --bg-dark: #0f0f1a;
            --bg-card: #1a1a2e;
            --accent: #e94560;
            --gold: #ffd700;
            --text: #eaeaea;
            --text-dim: #a0a0a0;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 2px solid var(--accent);
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--gold), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            color: var(--gold);
            margin: 2rem 0 1rem;
        }

        p {
            margin: 1rem 0;
        }

        .internal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .internal-card {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--accent);
        }

        .internal-card h3 {
            color: var(--gold);
            margin: 0 0 0.5rem;
        }

        .internal-card p {
            color: var(--text-dim);
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        pre {
            background: #0d1321;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--gold);
        }

        a {
            color: var(--gold);
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: var(--text-dim);
            border-top: 1px solid var(--accent);
            margin-top: 3rem;
        }
    </style>
</head>


    <!-- Breadcrumbs -->
    <div class="breadcrumbs">
        <div class="breadcrumbs-container">
            <ul class="breadcrumb-list">
                <!-- Breadcrumbs will be generated by JavaScript -->
            </ul>
        </div>
    </div>
    <div class="container">
        <header>
            <h1>?? Language Internals</h1>
            <p style="color: var(--text-dim);">Deep dive into Ifá-Lang's implementation</p>
        </header>

        <p>This section documents the internal architecture of Ifá-Lang for contributors and advanced users.</p>

        <h2>Core Components</h2>
        <div class="internal-grid">
            <div class="internal-card">
                <h3>?? AST & Parser</h3>
                <p>Grammar, lexer, and abstract syntax tree representation.</p>
                <p><strong>Source:</strong> <code>ifa-core/src/ast.rs</code>, <code>parser.rs</code></p>
            </div>

            <div class="internal-card">
                <h3>?? Compiler</h3>
                <p>AST to bytecode compilation.</p>
                <p><strong>Source:</strong> <code>ifa-core/src/compiler.rs</code></p>
            </div>

            <div class="internal-card">
                <h3>??? Virtual Machine</h3>
                <p>Stack-based bytecode interpreter.</p>
                <p><strong>Source:</strong> <code>ifa-core/src/vm.rs</code></p>
            </div>
        </div>

        <h2>Execution Pipeline</h2>
        <pre><code>Source Code (.ifa)
      ?
   Lexer (tokenize)
      ?
   Parser (AST)
      ?
   Babalawo (static analysis)
      ?
   Compiler (bytecode)
      ?
   VM (execute)</code></pre>

        <h2>Key Data Structures</h2>

        <h3>IfaValue</h3>
        <p>The core value type representing all Ifá-Lang values:</p>
        <pre><code>// From crates/ifa-core/src/value.rs
pub enum IfaValue {
    Nil,
    Bool(bool),
    Number(f64),
    String(Rc<String>),
    List(Rc<RefCell<Vec<IfaValue>>>),
    Map(Rc<RefCell<HashMap<String, IfaValue>>>),
    Function(Rc<Function>),
    NativeFunction(Rc<NativeFunction>),
    // ...
}</code></pre>

        <h3>OpCode</h3>
        <p>Bytecode instructions:</p>
        <pre><code>// From crates/ifa-core/src/bytecode.rs
pub enum OpCode {
    LoadConst(u16),
    LoadLocal(u16),
    StoreLocal(u16),
    Add, Sub, Mul, Div,
    Call(u8),
    Return,
    Jump(i16),
    JumpIfFalse(i16),
    // ...
}</code></pre>

        <h2>Crate Dependencies</h2>
        <pre><code>ifa-cli
   +-- ifa-core
         +-- ifa-std (domains, stacks, infra)
         +-- ifa-babalawo (linting)
         +-- ifa-types (shared types)

ifa-wasm
   +-- ifa-core (subset without native features)</code></pre>

        <h2>Further Reading</h2>
        <ul style="margin-left: 1.5rem;">
            <li><a href="../../community/community.html">Contributing Guide</a></li>
            <li><code>crates/README.md</code> — Detailed crate documentation</li>
            <li>Source code comments (rustdoc)</li>
        </ul>

        <footer class="doc-footer">
            <p><a href="../../api/api.html">? API Reference</a></p>
            <p><a href="../../index.html">Documentation Home</a></p>
        </footer>
    </div>
    <script src="../../js/nav.js"></script>
    <script src="../../js/common.js"></script>
</body>

</html>

