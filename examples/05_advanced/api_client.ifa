// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API_CLIENT.IFA - REST API Client Example
// Demonstrates HTTP requests, JSON parsing, and async operations
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Run: ifa run examples/05_advanced/api_client.ifa
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã¬bÃ  Irosu;    // Output
Ã¬bÃ  Otura;    // Network
Ã¬bÃ  Ika;      // Strings
Ã¬bÃ  Ogunda;   // Arrays
Ã¬bÃ  Ofun;     // Objects

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HTTP CLIENT CLASS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

odÃ¹ HttpClient {
    ayanmá» base_url = "";
    ayanmá» headers = {};
    
    ese dÃ¡(url) {
        base_url = url;
        headers = Ofun.da();
        headers = Ofun.fi(headers, "Content-Type", "application/json");
        headers = Ofun.fi(headers, "User-Agent", "Ifa-Lang/1.0");
    }
    
    ese set_header(key, value) {
        headers = Ofun.fi(headers, key, value);
    }
    
    ese get(endpoint) {
        ayanmá» url = Ika.so(base_url, endpoint);
        Irosu.fo("ğŸ“¤ GET " + url);
        
        ayanmá» response = Otura.http_get(url, headers);
        
        ti response.status == 200 {
            Irosu.fo("âœ… Success: " + response.status);
            padÃ  response.body;
        } bibáº¹ká» {
            Irosu.fo("âŒ Error: " + response.status);
            padÃ  iro;
        }
    }
    
    ese post(endpoint, data) {
        ayanmá» url = Ika.so(base_url, endpoint);
        Irosu.fo("ğŸ“¤ POST " + url);
        
        ayanmá» response = Otura.http_post(url, headers, data);
        
        ti response.status >= 200 && response.status < 300 {
            Irosu.fo("âœ… Success: " + response.status);
            padÃ  response.body;
        } bibáº¹ká» {
            Irosu.fo("âŒ Error: " + response.status);
            padÃ  iro;
        }
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// JSON HELPER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

odÃ¹ Json {
    ese parse(text) {
        // Parse JSON string to object
        padÃ  Ofun.from_json(text);
    }
    
    ese stringify(obj) {
        // Convert object to JSON string
        padÃ  Ofun.to_json(obj);
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXAMPLE: FETCH USERS FROM API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Irosu.fo("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
Irosu.fo("â•‘        IfÃ¡-Lang API Client Demo                          â•‘");
Irosu.fo("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

// Create HTTP client
ayanmá» client = HttpClient.dÃ¡("https://jsonplaceholder.typicode.com");

// Fetch users
Irosu.fo("\nğŸ“‹ Fetching users...");
ayanmá» users_json = client.get("/users");

ti users_json {
    ayanmá» users = Json.parse(users_json);
    
    Irosu.fo("\nğŸ‘¥ Users found: " + Ogunda.gigun(users));
    
    // Display first 3 users
    ayanmá» i = 0;
    fun user ninu users {
        ti i < 3 {
            Irosu.fo("  - " + user.name + " (" + user.email + ")");
        }
        i = i + 1;
    }
}

// Create a new post
Irosu.fo("\nğŸ“ Creating new post...");
ayanmá» new_post = Ofun.da();
new_post = Ofun.fi(new_post, "title", "Hello from IfÃ¡-Lang!");
new_post = Ofun.fi(new_post, "body", "This post was created using IfÃ¡-Lang.");
new_post = Ofun.fi(new_post, "userId", 1);

ayanmá» result = client.post("/posts", Json.stringify(new_post));

ti result {
    Irosu.fo("ğŸ“¬ Post created successfully!");
    ayanmá» created = Json.parse(result);
    Irosu.fo("   ID: " + created.id);
}

// Fetch a single post
Irosu.fo("\nğŸ“„ Fetching post #1...");
ayanmá» post = client.get("/posts/1");

ti post {
    ayanmá» data = Json.parse(post);
    Irosu.fo("   Title: " + data.title);
}

Irosu.fo("\nğŸ‰ API demo complete!");
Ã á¹£áº¹;
